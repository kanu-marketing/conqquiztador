<html xmlns="http://www.w3.org/1999/xhtml">
<head>
    <title>Conqquiztador</title>
    <link rel="stylesheet" type="text/css" href="styles/style.css">
    <script src="scripts/jquery-1.10.0.js"></script>
    <script src="scripts/prototype.js"></script>
    <script src="scripts/q.js"></script>
    <script src="game-view-model/game-field.js"></script>
    <script src="game-view-model/players.js"></script>
</head>
<body>
    <div id="wrapper">
        <div id="game_field" class="container">
            <button id="new_game">Start game</button>
            <button id="stop_game">Stop game</button>
            <button id="help">Help</button>
            <div id="mouse_pointer">
                <img id="flag" class="flags" src="images/red_flag.png" alt="Red flag">
            </div>
        </div>
        <div id="question_box" class="container">
            <div id="question_child">
                <h3>Question</h3>
            </div>
            <div id="mc-question-container"></div>
        </div>
        <div id="player" class="container">
            <!--<div class="player_id">
            <div class="name">
                <span>Player</span>
            </div>
            <div class="points">
                <span>Points</span>
            </div>
        </div>
        <hr />
        <div class="player_flags">
            <p>All flags go here</p>
            <p><span>new flag</span> <span>new flag</span> <span>new flag</span> </p>
        </div>-->
        </div>
        <div id="dummy_player" class="container"></div>
    </div>
    <script src="game-view-model/question.js"></script>
    <script src="game-view-model/renderer.js"></script>
    <script>
        (function ($) {

            var gameRenderer = new Renderer();
            gameRenderer.renderWelcome();
            
            $("#new_game").on('click', function () {
                var gameStarter = new StartGame();
                gameStarter = gameStarter.startNewGame();

                $(".flags").on('click', function () {
                    $("#" + this.id).hide();
                    $("#red_" + this.id).show();
                    console.log(this.id);
                    $.getJSON("model/bd-multiple-choice-questions.js", function (data) {
                        var questionsNumber = data.length;

                        var index = Math.floor((Math.random() * 100 + 1) % questionsNumber);
                        var question = QuestionParser.parseMultipleChoiceQuestion(data[index]);

                        // TODO: check if question is has been already shown
                        $("#mc-question-container").html(question.render());

                    });
                });
                           
                $("stop_game").on('click', function () {
                    //gameStarter.stopGame();
                     $("#mouse_pointer").empty();
                });
            });

            var nickname = "";
            $("#nickname-button").on("click", function () {
                nickname = document.getElementById("nickname").value;
                $("#welcome-screen").fadeOut(1000).promise()
                    .then(function () {
                        $("#wrapper").fadeIn(1000)
                    })
                    .then(function () {
                        var player = new Player(nickname);
                        var dummyPlayer = new DummyPlayer();

                        $("#player").append(player.render("player_child"));
                        $("#dummy_player").html(dummyPlayer.render("dummy_child"));

                    });
            });
        }(jQuery));
    </script>
</body>
</html>
